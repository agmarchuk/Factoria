@using Microsoft.AspNetCore.Components.Authorization
@using Family.Authentication
@inherits LayoutComponentBase
@inject AuthenticationStateProvider authStateProvider
@inject NavigationManager navManager

<PageTitle>SypBlazor</PageTitle>

<div class="page">
    @if (expandSubNav)
    {
        <div class="sidebar" style="position:absolute;margin-top:64px;">
            <AuthorizeView>
                <Authorized>&nbsp;&nbsp;<span>@(context.User.Identity?.Name)</span> <a @onclick="Logout" href="javascript:voi(0)">Logout</a></Authorized>
                <NotAuthorized><a href="/login">Login</a></NotAuthorized>
            </AuthorizeView>
            <a href="login" style="color:white;margin-left:20px;padding-top:20px;">
                login
            </a>
            @* <div class="nav-scrollable" @onclick="ToggleNavMenu">
                <nav class="flex-column">
                    <div class="nav-item px-3">
                        <NavLink class="nav-link" href="" Match="NavLinkMatch.All">
                            <span class="oi oi-home" aria-hidden="true"></span> Home
                        </NavLink>
                    </div>
                    <div class="nav-item px-3">
                        <NavLink class="nav-link" href="counter">
                            <span class="oi oi-plus" aria-hidden="true"></span> Counter
                        </NavLink>
                    </div>
                    <div class="nav-item px-3">
                        <NavLink class="nav-link" href="fetchdata">
                            <span class="oi oi-list-rich" aria-hidden="true"></span> Fetch data
                        </NavLink>
                    </div>
                </nav>
            </div> *@
        </div>
    }


    <main>

        <nav class="navbar navbar-expand-xxl navbar-light bg-light" style="height:64px; padding-top:0px;  background-image:url(VertPoloska.jpg)">
            <div class="container-fluid" style="padding-left:0px; padding-top:0px;">
                <a class="navbar-brand" href="#">
                    @*<img src="FlyingBirdsSmall.jpg" alt="" width="268" height="64" style="">*@
                    <img src="SYPlogo.png" alt="" height="60" style="">
                </a>
                <div class="navbar-text">
                    <!-- <span style="color: black; font-size:larger; font-weight: bold;">Семейный архив</span>
                    <span>Марчуки, Беляевы, Кириковы, Петерсоны и др.</span> -->
                    <span style="color: black; font-size:larger; font-weight: bold;">Летняя школа юных программистов</span>
                    <span>архив ЛШЮП 1976-2023</span>
                </div>

@*                <form class="d-flex">
                    <input class="form-control me-2" type="search" placeholder="текст поиска" />
                    <button class="btn btn-outline-success" type="submit">Искать</button>
                </form>
*@
                <NavLink class="nav-link" @onclick="()=>expandSubNav = !expandSubNav">
                    <span class="navbar-toggler-icon"></span>
                </NavLink>

            </div>
        </nav>



        <article class="content px-4">



            @Body
        </article>
    </main>
</div>

@code {
    private bool collapseNavMenu = false;

    private string? NavMenuCssClass => collapseNavMenu ? "collapse" : null;

    private void ToggleNavMenu()
    {
        collapseNavMenu = !collapseNavMenu;
    }

    private bool expandSubNav;

    // Authorization
    private async Task Logout()
    {
        var customAuthStateProvider = (CustomAuthenticationStateProvider)authStateProvider;
        await customAuthStateProvider.UpdateAuthenticationState(null);
        navManager.NavigateTo("/home/", true);
    }
}