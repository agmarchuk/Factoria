
Теперь надо упорядочить некоторые обратные ссылки. Это касается отношений: отражения, элемент коллекции, документы под документом. 
Отражения упорядочиваются по времени отражения, если его нет, то по времени создания документа.
Элементы коллекции могут не упорядочиваться. 
Поддокументы упорядочиваются по номерам страниц.

Но для проверки, надо бы выделить случаи, когда элементы будут визуализироваться полотном. 

До полотна я ак и не добрался, пока локализовываю и исправляю ошибки в обработке данных. Не всегда понятно как исправлять.
Вот столкнулся с обшибкой в виде наличия в оперативной базе данных элемента delete. Его там не должно быть по логике построения. 
Но как-то просачивается. Нужно сделать "отсечку", фиксирующую стандарт представления базы данных. И видимо сделать новый (а может и старый)
вариант достижения этого состояния. 

Эти проблемы возникают при построении базы данных. И во многом, они определяются "старыми" дефектами в структуре. Это iiss-элемент, старый
delete и старый substitute. Надо эту трансляющию сделать так, чтобы и старые и новые fog-файлы давали один результат. 

Восстановил старый вариант и все заработало! Надо бы проверить на Family. 

### 20251220 16:37
Предыдущий текст написан когда-то давно. Но сейчас я должен модернизировать программу SypBlazor и мне требуется тетрадь для рассуждений.

Я сейчас решаю задачу корректной сортировки объектов визуализации. В текущей онтологии это требуется для трех случаях: для отражений, для членов 
коллекций, для многостраничных документов. Первая часть изменений - правильная организация сортировок. Во-первых, выявляется набор записей
принадлежности. Задача состоит в том, чтобы переставить элементы в этом наборе в соответствии с критериями. Потом находятся ключи или критерии 
сортировки. Можно их вычислять динамически в самой сортировке, но экономнее будет вычислить по паре ключей на запись. Первый - для первичной 
сортировки, а второй - для вторичной, т.е. первичная сортировка выявляется группы, упорядоченные по первому критерию, а потом каждая группа 
сортируется по второму критерию. Для многостраничных документов первичным критерием является номер страницы (этот номер - атрибут отношения), 
для отражения и принадлежности коллекции, первичым критерием является дата объекта отражения или коллекции (таргетного объекта). Пока не было рассмотрено отношение
participation, а там первичным критерием является fom-date для членства. Вторичным критерием во всех случаях является имя таргетного объекта.

Задачу буду решать через выделение нужного набора Rec[] и дальнейшей сортировки элементов с возвращением "на место". Эту задачу надо решать для
двух случаев: для первичного дерева tree через обратные отношения, для специально сформированного вспомогательного дерева, начинающегося от
переднного извне идентификатора eid группирующего дерева. Итак, интерфейс сортировки должен выглядет как: 
```
void SortRelRecords(Rec[] recs, Rec r => )
```

