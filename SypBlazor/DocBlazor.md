# Приложение редактирования данных Отрытого архива

### Введение
Приложение OpenEd (Редактор открытого архива) является составной частью фактографической системы, созданной	в ИСИ СО РАН для ведения электронных архивов общего назначения, фиксирующих факты и документы широкого профиля. В контексте приложения имеются следующие роли: пользователь - человек, использующий электронный архив в своих целях, оператор - человек, создающий и описывающий архив и данные этого архива, источник информации - человек или организация, предоставляющие документы или данные для архива, администратор - специалист, управляющий общим содержимым архива или системы архивов. Архивными элементами являются так называемые кассеты. Можно было бы провести аналогию со шкафами обычного "бумажного" архива. Кассеты являюся единицами накопления документов и данных. В отличие от традиционных хранилищ, кассеты являются более гибким средством группирования информации. Главным элементом такого группирования, являются так называемые сборки, когда под единым входом, объединяется какой-то набор кассет. Такой вход становится тематическим архивом. Например, Открытый архив СО РАН объединяет документы и данные, собранные по теме "Жизнь и творчество Сибирского отделения Академии наук, ее людей и организаций". Накопленные и использованные в рамках одного проекта-сборки кассеты, могут быть использованы в других проектах.   

Типовым сценарием создания электронного архива является следующий. Документы подготавливаются для ввода в архив, сканируются, фотографируются и т.д., происходит ввод документов. Документы вводятся в виде кассет, представляющих собой первичные наборы. Оператор или операторы формируют систему структуризации документов, разрабатывают принципы инфорационного окружения. Далее идет описание документов кассет, документы помещаются в те или иные коллекции. При описании документов фиксируются авторы, персонажи, дополнительная информация. В нужных случаях добавляется оформительская информация, например к коллекции может быть прикреплена фотография, символизирующая содержание коллекции.    

### Инструкция оператору
Приложение является Web-приложением и доступно оператору через определенный URL-вход. Например, Открытый архив СО РАН (пока) доступен через http://gea.iis.nsk.su/OpenEd

Будем называть множество документов и данных, доступных через приложение электронным архивом или просто архивом. В нем фиксируются мультимедиа документы и информация, описывающая эти документы, а также фрагмент реального мира, относящийся к документам. Через доступный интерфейс (frontend) можно осуществлять такие действия как просмотр архива, поиск в архиве, редактирование данных архива, добавление документов.

### Хранимые документы
Документами архива являются электронные копии (обычно сканы) документов, имеющими смысл для хранения. Это могут быть мультимедиа документы, такие как фотографии (в электронном виде), видео, аудио, документы форматов PDF, TXT и некоторых других видов. Документ может иметь форму визуализации и быть доступным для просмотра, но может быть просто файлом и действия с документом могут осуществляться внешними программами. Тогда документ можно "вытащить" (download) и работать с ним отдельно. У документа могуть быть разные детальности просмотра. Например, фотографии хранятся в разных разрешениях, что позволяет экономно расходовть сетевой трафик при доступе, особенно множественном, к ним. 

### Данные
Для понимания и детализации документов архива, строится системма описаний или база данных. Например, у документа может быть название, автор(ы), описание, указание какие изображены (отражены) персонажи, время, место и др. информация. Соответственно в описаниях появляются люди, организации, географические места. Документы, особенно рукописные, могут быть транскрибированы, переведены и т.д. Документ может не содержать файла (файлов) мультимедиа или состоять из множества поддокументов как книга состоит и глав, разделов, параграфов. Все это фиксируется данными (информацией, метаинформацией), вводимой, как правило, вручную. 

Данные также представляют широкий круг отношений между документами и персонажами (объектами) архива. Например, отношение "персонаж X отражен в документе Y" довольно типичное и часто используемое отношение. Иногда (довольно часто) отношение имеет важные атрибуты, которые хорошо бы указывать. Например, отношение "персонаж X работает в организации Y" хорошо бы снабдить такими атрибутами как временные рамки и должность в которой он работает или работал. 

### Коллекции
Коллекции являются способом логического группирования материала. Могут быть коллекции документов, это очень типичный случай, но могут быть и другие коллекции. Коллекции появляются часто автоматически, напр. при вводе новых групп документов, группирование осуществляется коллекциями или кассетами. Но могут быть созданы и наполняться операторами. Интерфейс оператора имеет небольшое количество групповых функций, ориентированных на ускорение работы с коллекциями. 

### Мультистраничные документы
Документ может состоять из частей т.е. поддокументов, части могут быть "пронумерованы" условными номерами страниц. Сканы отдельных страниц документа обычно объединяются в общий документ через такие механизмы.

### Навигация и поиск
Навигация, т.е. определение направления движения по материалам архива осуществляется обычным для Web-ресурсов образом - через гиперссылки. Как правило, гиперссылки порождаются автоматически из структурных свойств и отношений. 

Поиск выполняется через задание поискового запроса, когда фиксируется поисковый текст и тип объектов среди которых выполняется поиск. Вариантом "по умолчанию" является поиск по началу имени объекта. Например, поиск персонажа "Иванов Егор Иванович" может выполняться по полному имени или запросу "Иванов" или "ива" вплото до одной первой буквы. Указание типа объекта вычленяет из найденного множества только нужные тип. Еще есть чекбокс "расш." что означает "расширение". При расширеном запросе поисковый запрос состоит из одного или нескольких слов, которые ожидаются в названии. Причем слова должны быть указаны полностью. Например для расширенного поиска указанного Иванова можно использовать запрос "иванович". Причем поиск ведется не только в имени документа, но и в тексте документа если он есть.

Иногда не очевидно с чего начать просмотр и редактирование имеющейся сборки. Полезно знать, что кассеты представляют собой коллекции (документов, коллекций). Причем в сборке коллекции собраны в "суперколлекцию" под названием "коллекции". Поэтому через поисковый интерфейс имеет смысл найти этот набор и далее углубляться в отдельные его разделы. 

### Типы объектов базы данных
Фактографическая система поддерживает следующие типы объектов, возможных к ипользованию в базе данных. Это персоны, организационные системы, документы разных видов, географические системы, коллекции. И есть частные случаи, напр. кассеты, являющиеся подклассом коллекции.

### Используемые в базе данных отношения
Прямых (в смысле RDF) отношений в используемой онтологии неспецифических сущностей только два: указатель персоны на отца и указатель на мать. Все остальные отношения - составные, т.е. могущие содержать атрибуты. Основные отношения: для пары персона-персона - это "семья", для пары персона-орг.система - обучение, участие (работа), для пар документ-что-то - отражение, для пары персона-документ автор, источник, получатель, для пары гео-система-что-то - размещение. Есть еще специальные отношения - степень/титул, именование, датирование. 

### Переход в режим редактирования
Редактирование электронного архива осуществляется коллективно. Обычно за оператором закрепляется направление его работы и/или группа обрабатываемых документов. Оператор должен быть допущен к работе над редактированием. Для этого администратор делает внутренние пометки и, по согласованию, выдает оператору login (user name) и password. В меню пользовательского интерфейса OpenEd есть раздел входа. Если вход в режим релактирования пройдет успешно, то в конце каждой следующей страницы будет напоминание user=имя пользователя.

В режиме редактирования интерфейс с системой несколько изменится. Появятся команды перехода к редактированию той или иной части и уничтожения тех или иных данных.

### Отображение объектов на экране
Модель объектов более или менее одинаковая, различия заключаются в наборах полей и отношений. Объект визулизируется в виде одной или нескольких таблиц. Обязательны заголовои и первая таблица. В заголовке первым идет тип объекта, напр. "Персона". Следующим словом идет идентификатор объекта. Далее идет таблица, состоящая из одной заголовочной строки и одной строки с данными. Это поля или атрибуты объекта. Обычно есть поле имя. Другие поля также интеитивно понятны: нач.дата, описание, кон.дата и др. Кроме слова "объект" далее по тексту будет использовано и слово "персонаж".

После этого, идет таблицы, определяющие отношения этого объекта с другими. Детали этих информационных блоков будут описаны далее по тексту.

### Редактирование данных
Редактирование фактографических данных выполняется только пользователями, имеющими на это полномочия. Полномочия состоят из общего разрешения пользователю производить изменения в базе данных и наличия документа, который будет "принимать" эти изменения. Первая часть решается через авторизацию. Системный администратор прописывает специальном файле всех пользователей, которым разрешено выполнять редактирование. Для каждого такого пользователя указывается имя пользователя, это некоторое слово, идентифицирующщее пользователя и password, т.е. секретный код. Эта пара пользователем указывается при авторизации.

После авторизации, объекты или персонажи визуализируется несколько по другому. Где нужно, добавляются кнопки в виде гиперссылок ред., x, нов. Сначала познакомимся с редактированием основной информации о персонаже. 

#### Заведение персонажа

Для заведения нового объекта или персонажа, нужно указать тип этого объекта в комбо-боксе выбора (Персона, Организационная система, Геосистема и т.д.) и ввести в поле текстового поиска имя персонажа или начало имени. После нажатия на <enter> или кнопки "Искать", появится набор вариантов, найденных по данному запросу, возможно, таких вариантов нет. Но также появится "кнопка" "нов." дающая возможность завести новый персонаж с указанным именем. Нажатие на нее произведет желаемое действие и переместит оператора в посмотр/редакирование нвого объекта. 

#### Уничтожение персонажа

В главной таблице объекта есть команда x, обозначющая уничтожение объекта. Этой команды может не быть, но об этом будет написано позже.

#### Редактирование таблицы

Любая таблица может быть отредактирована через редактирование строк с данными если в конце строки есть команда "ред." или "x". Убирание строки из таблицы делается через x. Соответственно, если строка является единственной (последней), то исчезнет и таблица, а в случае главной таблицы - исчезнет и объект. Нажатие на команду "ред." приводит к изменению режима визуализации данной строки. Теперь имена колонок переносятся влево, в отдельный столбец, а справа будет зона редактирования отдельных полей. Кроме того, внизу появятся кнопки команд OK и Cancel. Вторая команда приводит к отказу от данного редактирования (есть важное исключение, но об этом - позже).

Если Вы изучаете возможности редактора впервые, то рекомедуется завести тестовые персонажи и на них практиковаться. Например, давайте заведем тестовую персону Тестов Тест Тестович и начнем редактировать этот объект. Мы увидим ряд полей, значением которых должны быть тексты. Это "имя", "нач.дата", "описание", "кон.дата", "комментарий". Некоторые из этих полей заполняются на "универсальном" языке цифр, напр. даты, некоторые могут заполняться на разных языках. Сейчас задействованы русский (ru) и английский (en). В дальнейшем список языков будет расширен. Универсальные поля заполняются напрямую, а языковые - с предварительным выбором языка. Есть поля с перечислимыми значениями, напр. поле "пол" с выбором варианта пользователем. Есть поля - ссылки на другие объекты. Например, для персоны можно указать ссылку на отца и/или мать. Чтобы это сделать надо воспользоваться мини поисковым интерфейсом. Как и в основном поиске, набирается поисковый запрос в виде типа и имени сущности, если сущность с заданными свойствами находится, то связываем ее с редактируемой. Если нет, то по нажатию "нов." будет создан объект и связь с ним. Например, попробуем описать отца. Вводим в поле "отец" поисковый образ "Тестов Отец" типа "Персона". Потом выберем вариант "нов", породим нового персонажа как отца.

Информационная композиция конкретной сущности называется информационным портретом. Общая схема информационного портрета формируется следующим образом: Сначала идут тип сущности и идентификатор сущности, потом идет таблица с единственной строкой, в ней перечисляются поля и ссылки данной сущности. Ссылки (напр. "отец"), если они есть, изображаются в виде имени объектаЖ, оформленного как гиперссылка. Потом идут так называемые обратные отношения. Они строятся как название отношения и таблица объектов, парных по данному отношению. 

#### Отношения в описаниях

Между объектами онтология предполагает отношения. Между персонами это отношения ребенок-отец, ребенок-мать, супруги. Между персонами и организационными системами есть отношение "участие". Между разными сущностями и документами есть отношение "отражение", когда в документе отражены (изображены, упомянуты, описаны и т.д.) эти сущности. Между разными сущностями и географическими объектами есть отношение "расположение". 

Важно знать, что отношения обладают симметрией в том смысле, что при наличии отношения между объектами А и Б объект Б также относится к объекту А. Но названия отношений, скорее всего будут отличаться. Например, у персоны может быть "ребенок" (это название отношения), но у персоны-ребенка будет "родитель" (обратное отношение). К этому надо привыкнуть иначе возникнет путаница.

Большинство видов отношений в нашей онтологии выстраиваются как псевдосщности, т.е. вроде это сущность, но она указывает на относящиеся между собой объекты. Мнемонически, сущность это то на что можно указать (пальцем) и то, что часто имеет имя. Псевдосущности не обладают этими свойствами. Например, есть псевдосущность, являющаяся сложным отношением: "отражение", которая устанавливает связь между сущностями "отражаемое" и "в документе". 

### Системному администратору


